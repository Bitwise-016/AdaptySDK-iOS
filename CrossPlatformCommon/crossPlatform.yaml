$schema: 'https://json-schema.org/draft/2020-12/schema'
$id: 'https://adapty.io/crossPlatform/3.0.0/schema'
title: 'Cross Platform Format'

$defs:
###Function###

  ### setDelegate ###

  ### getSDKVersion ###

  GetSDKVersion.Request:
    type: object
    required: [name]
    properties:
      name: { const: "get_sdk_version" }

  GetSDKVersion.Response:
    type: object
    required: [value]
    properties:
      value: { type: string  }

  ### isActivated ###

  IsActivated.Request:
    type: object
    required: [name]
    properties:
      name: { const: "get_is_activated" }

  IsActivated.Response:
    type: object
    required: [value]
    properties:
      value: { type: boolean  }

  ### getLogLevel ###

  GetLogLevel.Request:
    type: object
    required: [name]
    properties:
      name: { const: "get_log_level" }

  GetLogLevel.Response:
    type: object
    required: [value]
    properties:
      value: { $ref: "#/$defs/AdaptyLog.Level" }

  ### setLogLevel ###

  SetLogLevel.Request:
    type: object
    required: [name, value]
    properties:
      name: { const: "set_log_level" }
      value: { $ref: "#/$defs/AdaptyLog.Level" }

  SetLogLevel.Response:
    type: object

  ### activate ###
  Activate.Request:
    type: object
    required: [name, configuration]
    properties:
      name: { const: "activate" }
      configuration: { $ref: "#/$defs/AdaptyConfiguration" }

  Activate.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### getPaywall ###

  GetPaywall.Request:
    type: object
    required: [name, placement_id]
    properties:
      name: { const: "get_paywall" }
      placement_id: { type: string }
      locale: { type: string }
      fetch_policy: { $ref: "#/$defs/AdaptyPaywall.FetchPolicy" }
      loadTimeout: { type: number }

  GetPaywall.Response:
    type: object
    oneOf:
    - required: [error]
      properties:
        error: { $ref: "#/$defs/AdaptyError" }
    - required: [value]
      properties:
        value: { $ref: "#/$defs/AdaptyPaywall" }

  ### getPaywallProducts ###

  GetPaywallProducts.Request:
    type: object
    required: [name, paywall]
    properties:
      name: { const: "get_paywall_products" }
      paywall: { $ref: "#/$defs/AdaptyPaywall"  }

  GetPaywallProducts.Response:
    type: object
    oneOf:
    - required: [error]
      properties:
        error: { $ref: "#/$defs/AdaptyError" }
    - required: [value]
      properties:
        value: { type: array, items: { $ref: "#/$defs/AdaptyPaywallProduct" } }

  ### getProfile ###

  GetProfile.Request:
    type: object
    required: [name]
    properties:
      name: { const: "get_profile" }

  GetProfile.Response:
    type: object
    oneOf:
    - required: [error]
      properties:
        error: { $ref: "#/$defs/AdaptyError" }
    - required: [value]
      properties:
        value: { $ref: "#/$defs/AdaptyProfile" }

  ### updateProfile ###

  UpdateProfile.Request:
    type: object
    required: [name, params]
    properties:
      name: { const: "update_profile" }
      params: {  $ref: "#/$defs/AdaptyProfileParameters"}

  UpdateProfile.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### identify ###

  Identify.Request:
    type: object
    required: [name, customer_user_id]
    properties:
      name: { const: "identify" }
      customer_user_id: { type: string }

  Identify.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### logout ###

  Logout.Request:
    type: object
    required: [name]
    properties:
      name: { const: "logout" }

  Logout.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### logShowOnboarding ###

  LogShowOnboarding.Request:
    type: object
    required: [name, params]
    properties:
      name: { const: "log_show_onboarding" }
      params: { $ref: "#/$defs/AdaptyOnboardingScreenParameters" }

  LogShowOnboarding.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### logShowPaywall ###

  LogShowPaywall.Request:
    type: object
    required: [name, paywall]
    properties:
      name: { const: "log_show_paywall" }
      paywall: { $ref: "#/$defs/AdaptyPaywall" }

  LogShowPaywall.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### makePurchase ###

  MakePurchase.Request:
    type: object
    required: [name, product]
    properties:
      name: { const: "make_purchase" }
      product: {  $ref: "#/$defs/AdaptyPaywallProduct" }

  MakePurchase.Response:
    type: object
    oneOf:
    - required: [error]
      properties:
        error: { $ref: "#/$defs/AdaptyError" }
    - required: [value]
      properties:
        value: { $ref: "#/$defs/AdaptyPurchaseResult" }

  ### restorePurchases ###

  RestorePurchases.Request:
    type: object
    required: [name]
    properties:
      name: { const: "restore_purchases" }

  RestorePurchases.Response:
    type: object
    oneOf:
    - required: [error]
      properties:
        error: { $ref: "#/$defs/AdaptyError" }
    - required: [value]
      properties:
        value: { $ref: "#/$defs/AdaptyProfile" }

  ### setFallbackPaywalls ###

  SetFallbackPaywalls.Request:
    type: object
    required: [name, url]
    properties:
      name: { const: "set_fallback_paywalls" }
      url: { type: string }

  SetFallbackPaywalls.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### setVariationId ###

  SetVariationId.Request:
    type: object
    required: [name, variation_id, transaction_id ]
    properties:
      name: { const: "set_variation_id" }
      variation_id: { type: string }
      transaction_id: { type: string }

  SetVariationId.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### updateAttribution ###

  UpdateAttribution.Request:
    type: object
    required: [name, attribution, source ]
    properties:
      name: { const: "update_attribution" }
      attribution: { type: object }
      source: { $ref: "#/$defs/AdaptyAttributionSource" }
      networkUser_id: { type: string }

  UpdateAttribution.Response:
    type: object
    properties:
      error: { $ref: "#/$defs/AdaptyError" }

  ### presentCodeRedemptionSheet ###

  PresentCodeRedemptionSheet.Request:
    type: object
    required: [name]
    properties:
      name: { const: "present_code_redemption_sheet" }

  PresentCodeRedemptionSheet.Response:
    type: object

###Adapty###
  AdaptyConfiguration: 
    type: object

  AdaptyConfiguration.ServerCluster:  
    type: enum

###PROTOCOLS###
  AdaptyDelegate:
    type: object

  AdaptyProduct:
    type: object

  AdaptyPaywallProduct:
    type: object

  CustomAdaptyError:
    type: object

###Structures###
  AdaptyError:
    type: object

  AdaptyError.Source:
    type: object

  AdaptyError.ErrorCode:
    type: enum

  AdaptyOnboardingScreenParameters:
    type: object

  AdaptyPaywall:
    type: object

  AdaptyPaywall.FetchPolicy:
    type: enum

  AdaptyPaywall.RemoteConfig:
    type: object

  AdaptyProductSubscriptionPeriod:
    type: object

  AdaptyProfile:
    type: object

  AdaptyProfile.AccessLevel:
    type: object

  AdaptyProfile.NonSubscription:
    type: object

  AdaptyProfile.Subscription:
    type: object

  AdaptyProfile.Gender:
    type: enum

  AdaptyProfileParameters:
    type: object

  AdaptyProfileParameters.Builder:
    type: object

  AdaptyStorefront:
    type: object

  AdaptySubscriptionOffer:
    type: object

  AdaptySubscriptionOffer.OfferType:
    type: enum
  
  AdaptySubscriptionOffer.PaymentMode:
    type: enum

  AdaptyAttributionSource:
    type: enum

  AdaptyPeriodUnit:
    type: enum

  AdaptyPurchaseResult:
    type: enum

  AdaptyLog.Level:
    type: enum

  AdaptyLog.Category:
    type: object

  AdaptyLog.Record:
    type: object

  AdaptyLog.Source:
    type: object
